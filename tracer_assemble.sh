
#/////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////
# script: tracer_assemble.sh
# author: Lincoln Harris
# date: 8.6.18
# 
# Lets run Derek's PR on all of our cells here
#/////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////
#!/bin/bash

driver () {
	docker run --rm -v $PWD:/scratch -w /scratch dcroote/tracer:add-cdr3 assemble --ncores 2 --species Hsap ./*_R1_001.fastq ./*_R2_001.fastq ${dir} ./trinity_out
}

root_dir=/home/ubuntu/sandbox_expansion1/05-tracer_derek_allCells

i=0

for dir in *; 
do 
	cd ${root_dir}/$dir
	#driver "$dir"
	driver "$dir" &
	cd .. 

	# limit to X number of procs
	if (( $i % 26 == 0 )); 
	then 
		wait; 
	fi
	i=$((i+1))
done

wait

#/////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////
